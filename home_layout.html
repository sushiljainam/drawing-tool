<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Layout Drawing Tool</title>
    <style>
        #canvas {
            border: 1px solid #000;
        }
        .input-group {
            margin-bottom: 10px;
        }
        #importExport {
            width: 100%;
            height: 100px;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="800" height="600"></canvas>
    <div id="controls">
        <div class="input-group">
            <button onclick="showInputs('line')">Add Line</button>
            <button onclick="showInputs('rectangle')">Add Rectangle</button>
            <button onclick="showInputs('label')">Add Label</button>
            <button onclick="showInputs('measurement')">Add Measurement</button>
            <button onclick="showInputs('arc')">Add Arc</button>
        </div>
        <div id="inputFields"></div>
        <div class="input-group">
            <button onclick="exportToClipboard()">Export to Clipboard</button>
            <button onclick="importFromTextarea()">Import from Textarea</button>
        </div>
        <textarea id="importExport" placeholder="Paste JSON here for import"></textarea>
    </div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let layout = {
            canvas: {
                width: 800,
                height: 600,
                scale: 1
            },
            elements: []
        };

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            layout.elements.forEach(element => {
                switch (element.type) {
                    case 'line':
                        drawLine(element);
                        break;
                    case 'rectangle':
                        drawRectangle(element);
                        break;
                    case 'label':
                        drawLabel(element);
                        break;
                    case 'measurement':
                        drawMeasurement(element);
                        break;
                    case 'arc':
                        drawArc(element);
                        break;
                }
            });
        }

        function drawLine(element) {
            ctx.beginPath();
            ctx.moveTo(element.x1, element.y1);
            ctx.lineTo(element.x2, element.y2);
            ctx.strokeStyle = element.strokeColor;
            ctx.lineWidth = element.strokeWidth;
            ctx.stroke();
        }

        function drawRectangle(element) {
            ctx.beginPath();
            ctx.rect(element.x, element.y, element.width, element.height);
            ctx.strokeStyle = element.strokeColor;
            ctx.lineWidth = element.strokeWidth;
            ctx.stroke();
            if (element.fillColor) {
                ctx.fillStyle = element.fillColor;
                ctx.fill();
            }
        }

        function drawLabel(element) {
            ctx.font = `${element.fontSize}px ${element.fontFamily}`;
            ctx.fillStyle = element.color;
            ctx.fillText(element.text, element.x, element.y);
        }

        function drawMeasurement(element) {
            drawLine(element);
            ctx.font = `${element.fontSize}px ${element.fontFamily}`;
            ctx.fillStyle = element.color;
            const textWidth = ctx.measureText(element.text).width;
            const midX = (element.x1 + element.x2) / 2 - textWidth / 2;
            const midY = element.y1 - 5;
            ctx.fillText(element.text, midX, midY);
        }

        function drawArc(element) {
            ctx.beginPath();
            ctx.arc(element.x, element.y, element.radius, element.startAngle * Math.PI / 180, element.endAngle * Math.PI / 180);
            ctx.strokeStyle = element.strokeColor;
            ctx.lineWidth = element.strokeWidth;
            ctx.stroke();
        }

        function showInputs(type) {
            const inputFields = document.getElementById('inputFields');
            inputFields.innerHTML = '';
            let html = '';

            switch (type) {
                case 'line':
                    html = `
                        <input type="number" id="x1" placeholder="x1">
                        <input type="number" id="y1" placeholder="y1">
                        <input type="number" id="x2" placeholder="x2">
                        <input type="number" id="y2" placeholder="y2">
                        <input type="color" id="strokeColor" value="#000000">
                        <input type="number" id="strokeWidth" placeholder="Stroke Width" value="2">
                    `;
                    break;
                case 'rectangle':
                    html = `
                        <input type="number" id="x" placeholder="x">
                        <input type="number" id="y" placeholder="y">
                        <input type="number" id="width" placeholder="width">
                        <input type="number" id="height" placeholder="height">
                        <input type="color" id="strokeColor" value="#000000">
                        <input type="number" id="strokeWidth" placeholder="Stroke Width" value="2">
                        <input type="color" id="fillColor" value="#FFFFFF">
                    `;
                    break;
                case 'label':
                    html = `
                        <input type="number" id="x" placeholder="x">
                        <input type="number" id="y" placeholder="y">
                        <input type="text" id="text" placeholder="Label Text">
                        <input type="number" id="fontSize" placeholder="Font Size" value="12">
                        <input type="text" id="fontFamily" placeholder="Font Family" value="Arial">
                        <input type="color" id="color" value="#000000">
                    `;
                    break;
                case 'measurement':
                    html = `
                        <input type="number" id="x1" placeholder="x1">
                        <input type="number" id="y1" placeholder="y1">
                        <input type="number" id="x2" placeholder="x2">
                        <input type="number" id="y2" placeholder="y2">
                        <input type="text" id="text" placeholder="Measurement Text">
                        <input type="number" id="fontSize" placeholder="Font Size" value="10">
                        <input type="text" id="fontFamily" placeholder="Font Family" value="Arial">
                        <input type="color" id="color" value="#666666">
                    `;
                    break;
                case 'arc':
                    html = `
                        <input type="number" id="x" placeholder="x">
                        <input type="number" id="y" placeholder="y">
                        <input type="number" id="radius" placeholder="radius">
                        <input type="number" id="startAngle" placeholder="Start Angle">
                        <input type="number" id="endAngle" placeholder="End Angle">
                        <input type="color" id="strokeColor" value="#000000">
                        <input type="number" id="strokeWidth" placeholder="Stroke Width" value="2">
                    `;
                    break;
            }

            html += `<button onclick="addElement('${type}')">Add ${type.charAt(0).toUpperCase() + type.slice(1)}</button>`;
            inputFields.innerHTML = html;
        }

        function addElement(type) {
            let element = { type, id: `${type}${layout.elements.length + 1}` };
            const inputs = document.getElementById('inputFields').getElementsByTagName('input');
            
            for (let input of inputs) {
                if (input.type === 'number') {
                    element[input.id] = parseFloat(input.value);
                } else {
                    element[input.id] = input.value;
                }
            }

            layout.elements.push(element);
            draw();
        }

        function exportToClipboard() {
            const jsonString = JSON.stringify(layout, null, 2);
            navigator.clipboard.writeText(jsonString).then(() => {
                alert('Layout exported to clipboard!');
            });
        }

        function importFromTextarea() {
            const textarea = document.getElementById('importExport');
            try {
                const importedLayout = JSON.parse(textarea.value);
                layout = importedLayout;
                draw();
                alert('Layout imported successfully!');
            } catch (error) {
                alert('Error importing layout. Please check the JSON format.');
            }
        }

        draw();
    </script>
</body>
</html>